<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html;
        charset=utf-8">


  <!-- D3 stuff -->
  <!-- <script src="https://d3js.org/d3.v5.min.js"></script> -->
  <script type="text/javascript" src="/static/js/libs/d3.min.js"></script>


  <!-- Leaflet -->

  <script src="/static/js/libs/leaflet.js"
    integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
    crossorigin="">
  </script>
  <script type="text/javascript" src="/static/js/libs/d3-concaveHull.js"></script>

  <link rel="stylesheet" href="/static/css/libs/leaflet.css" />



  <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />

  <!-- Leaflet.PolylineOffst -->
  <!-- https://github.com/bbecquet/Leaflet.PolylineOffset -->
  <!-- <script type="text/javascript" src="leaflet.polylineoffset.js"></script>
  <script type="text/javascript" src="leaflet-providers.js"></script> -->


  <!-- Our style -->
  <link rel="stylesheet" href="visualise.css" />

  <title>Voronoi test</title>

</head>

<body>

  <div id="map" style="height: 98vh; border: 1px solid black;"></div>

</body>
<!-- SECRETS -->
<script type="text/javascript" src="/static/js/secrets.js"></script>

<!-- Our scripts -->
<script type="text/javascript" src="/static/js/node_class.js"></script>
<script type="text/javascript" src="/static/js/data_building.js"></script>

<script type="text/javascript" src="/static/js/async_functions.js"></script>

<script type="text/javascript" src="/static/js/boundarySites.js"></script>
<script type="text/javascript" src="/static/js/dijkstra.js"></script>

<script type="text/javascript" src="/static/js/visualise.js"></script>
<script type="text/javascript" src="/static/js/cell_groups.js"></script>

<script type="text/javascript" src="/static/js/horizontal_bar_chart.js"></script>
<script type="text/javascript" src="/static/js/scatter_node.js" defer></script>


<script type="text/javascript">
  // var space_floorplan = new SpaceFloorplan();
  let current_date = new Date().toISOString().slice(0, 10).split('-').join('/');
  $(function () {

    $('input[name="datefilter"]').daterangepicker({
      showDropdowns: true,
      timePicker: true,
      format: 'dd/mm/yy' ,
      locale: { format: 'DD/MM/YYYY' },
      timePickerIncrement: 15,
      opens: "center"
    }, function (start, end, label) {
      //let URLhistoric_test_url='https://tfc-app1.cl.cam.ac.uk/api/v1/traffic/btjourney/history/'+link_id+'/?start_date='+start_date+'&end_date='+end_date
      console.log('New date range selected: ' + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD') +
        ' (predefined range: ' + label + ')');
      console.log(start, start._d.getTime(), end, end._d.getTime()); //.getTime() / 1000
      let start_date = start.format('YYYY-MM-DD');
      let end_date = end.format('YYYY-MM-DD');
      show_node_information(selected_node, start_date, end_date);

    });


    $('input[name="datefilter"]').on('apply.daterangepicker', function (ev, picker) {
      $(this).val(picker.startDate.format('YYYY-MM-DD') + ' - ' + picker.endDate.format('YYYY-MM-DD'));
      let start_date = picker.startDate.format('YYYY-MM-DD');
      let end_date = picker.endDate.format('YYYY-MM-DD')
      console.log('applied', start_date, end_date)
      show_node_information(selected_node, start_date, end_date);

    });

    $('input[name="datefilter"]').on('cancel.daterangepicker', function (ev, picker) {
      $(this).val('');
    });

  });
</script>


</html>